{% import "nav_macros.html" as nav %}
{% block content %}

<h1>Receipts</h1>

<form method="get" id="filters-form">
    Start Date:
    <input type="date" name="start_date" value="{{ start_date }}" onchange="this.form.submit()">
    End Date:
    <input type="date" name="end_date" value="{{ end_date }}" onchange="this.form.submit()">

    Payment Source:
    <select name="payment_source_name" onchange="this.form.submit()">
        <option value="">--All--</option>
        {% for ps_id, ps_name in payment_sources %}
            <option value="{{ ps_name }}" {% if ps_name == payment_source_name %}selected{% endif %}>{{ ps_name }}</option>
        {% endfor %}
    </select>
</form>


<div class="container">
    {% if receipts %}
        <table border="1" cellpadding="6" style="border-collapse:collapse; width:100%;">
            <thead>
                <tr>
                    <th>Description</th>
                    <th>Payment Source</th>
                    <th>Type</th>
                    <th>Transaction Date</th>
                    <th>Amount</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for t in receipts %}
                    <tr>
                        <td>{{ t.description }}</td>
                        <td>{{ t.payment_source_name }}</td>
                        <td>{{ t.debit_or_credit }}</td>
                        <td>{{ t.transaction_date.strftime("%Y-%m-%d") if t.transaction_date else "" }}</td>
                        <td>${{ "{:,.2f}".format(t.amount) }}</td>
                        <td>
                            {{ nav.receipts_edit(budget_id, t.pk_receipts_id) }}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No receipts found for this budget.</p>
    {% endif %}
</div>

<div class="btn-group2">
    {{ nav.receipts_home(budget_id) }}
</div>

{% endblock %}
