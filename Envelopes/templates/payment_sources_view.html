{% import "nav_macros.html" as nav %}
{% extends "base.html" %}

{% block title %}Payment Sources{% endblock %}

{% block content %}
<div class="home-container">

    <!-- Top right navigation -->
    <div class="header-links">
        {{ nav.payment_sources_home(budget_id) }}
        {{ nav.home() }}
        {{ nav.logout() }}
    </div>

    <!-- Main card -->
    <div class="card">
        <h1>Select Payment Source</h1>

        {% if payment_sources %}
            {% call nav.budget_select_default_post(budget_id) %}

                <ul class="single-select-list">
                    {% for source in payment_sources %}
                        <li class="single-select-item">
                            <label class="radio-row">
                                <input
                                    type="radio"
                                    name="selected_source"
                                    value="{{ source[0] }}"
                                    required
                                >
                                <span>{{ source[1] }}</span>
                            </label>
                        </li>
                    {% endfor %}
                </ul>

                <div class="btn-group">
                    <button type="submit" class="btn submit-btn">
                        Edit
                    </button>
                </div>

            {% endcall %}
        {% else %}
            <p class="empty-state">
                No payment sources found for this budget.
            </p>
        {% endif %}
    </div>

</div>

<script>
document.querySelector('form').addEventListener('submit', function(e) {
    e.preventDefault();
    const selected = document.querySelector('input[name="selected_source"]:checked');
    if (selected) {
        const id = selected.value;
        window.location.href = `${id}/edit`;
    } else {
        alert('Please select a payment source to edit.');
    }
});
</script>
{% endblock %}
